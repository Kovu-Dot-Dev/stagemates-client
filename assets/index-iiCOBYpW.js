import{c as M,p as me,r as m,q as Ee,j as e,s as Le,t as Y,v as ee,P as z,w as $,x as se,y as Je,z as $e,R as ze,A as qe,D as Ge,F as Be,E as We,G as He,a as H,C as P,e as I,f as T,b as F,d as v,B as N,u as Ke,m as Ye,L as xe,g as ue,M as he,U as V,I as C,i as le,k as re,l as ce,n as oe,o as k,S as Qe}from"./index-D5iRBa7c.js";import{u as pe,X as Ve,a as E,b as L,c as J,T as X,A as Xe,d as Q,C as Ze,U as Ue,M as de,L as w}from"./Textarea-3DY2kA4g.js";/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const es=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],ss=M("chevron-right",es);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const as=[["path",{d:"M2.992 16.342a2 2 0 0 1 .094 1.167l-1.065 3.29a1 1 0 0 0 1.236 1.168l3.413-.998a2 2 0 0 1 1.099.092 10 10 0 1 0-4.777-4.719",key:"1sd12s"}]],Z=M("message-circle",as);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ts=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],U=M("plus",ts);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ns=[["path",{d:"M20 18v-2a4 4 0 0 0-4-4H4",key:"5vmcpk"}],["path",{d:"m9 17-5-5 5-5",key:"nvlc11"}]],is=M("reply",ns);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ls=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],rs=M("send",ls);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cs=[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]],os=M("share-2",cs),ds=a=>{if(!a)throw new Error("id is required");return me.find(t=>t.id===a)},ms=(a,t)=>pe({queryKey:["jam",a],queryFn:()=>ds(a),enabled:!!a,...t});var K="Dialog",[je]=Le(K),[xs,D]=je(K),ge=a=>{const{__scopeDialog:t,children:r,open:c,defaultOpen:o,onOpenChange:l,modal:g=!0}=a,u=m.useRef(null),y=m.useRef(null),[s,f]=Ee({prop:c,defaultProp:o??!1,onChange:l,caller:K});return e.jsx(xs,{scope:t,triggerRef:u,contentRef:y,contentId:Y(),titleId:Y(),descriptionId:Y(),open:s,onOpenChange:f,onOpenToggle:m.useCallback(()=>f(S=>!S),[f]),modal:g,children:r})};ge.displayName=K;var fe="DialogTrigger",ve=m.forwardRef((a,t)=>{const{__scopeDialog:r,...c}=a,o=D(fe,r),l=ee(t,o.triggerRef);return e.jsx(z.button,{type:"button","aria-haspopup":"dialog","aria-expanded":o.open,"aria-controls":o.contentId,"data-state":ne(o.open),...c,ref:l,onClick:$(a.onClick,o.onOpenToggle)})});ve.displayName=fe;var ae="DialogPortal",[us,Ne]=je(ae,{forceMount:void 0}),ye=a=>{const{__scopeDialog:t,forceMount:r,children:c,container:o}=a,l=D(ae,t);return e.jsx(us,{scope:t,forceMount:r,children:m.Children.map(c,g=>e.jsx(se,{present:r||l.open,children:e.jsx(Je,{asChild:!0,container:o,children:g})}))})};ye.displayName=ae;var W="DialogOverlay",Ce=m.forwardRef((a,t)=>{const r=Ne(W,a.__scopeDialog),{forceMount:c=r.forceMount,...o}=a,l=D(W,a.__scopeDialog);return l.modal?e.jsx(se,{present:c||l.open,children:e.jsx(ps,{...o,ref:t})}):null});Ce.displayName=W;var hs=qe("DialogOverlay.RemoveScroll"),ps=m.forwardRef((a,t)=>{const{__scopeDialog:r,...c}=a,o=D(W,r);return e.jsx(ze,{as:hs,allowPinchZoom:!0,shards:[o.contentRef],children:e.jsx(z.div,{"data-state":ne(o.open),...c,ref:t,style:{pointerEvents:"auto",...c.style}})})}),R="DialogContent",we=m.forwardRef((a,t)=>{const r=Ne(R,a.__scopeDialog),{forceMount:c=r.forceMount,...o}=a,l=D(R,a.__scopeDialog);return e.jsx(se,{present:c||l.open,children:l.modal?e.jsx(js,{...o,ref:t}):e.jsx(gs,{...o,ref:t})})});we.displayName=R;var js=m.forwardRef((a,t)=>{const r=D(R,a.__scopeDialog),c=m.useRef(null),o=ee(t,r.contentRef,c);return m.useEffect(()=>{const l=c.current;if(l)return $e(l)},[]),e.jsx(De,{...a,ref:o,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:$(a.onCloseAutoFocus,l=>{l.preventDefault(),r.triggerRef.current?.focus()}),onPointerDownOutside:$(a.onPointerDownOutside,l=>{const g=l.detail.originalEvent,u=g.button===0&&g.ctrlKey===!0;(g.button===2||u)&&l.preventDefault()}),onFocusOutside:$(a.onFocusOutside,l=>l.preventDefault())})}),gs=m.forwardRef((a,t)=>{const r=D(R,a.__scopeDialog),c=m.useRef(!1),o=m.useRef(!1);return e.jsx(De,{...a,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:l=>{a.onCloseAutoFocus?.(l),l.defaultPrevented||(c.current||r.triggerRef.current?.focus(),l.preventDefault()),c.current=!1,o.current=!1},onInteractOutside:l=>{a.onInteractOutside?.(l),l.defaultPrevented||(c.current=!0,l.detail.originalEvent.type==="pointerdown"&&(o.current=!0));const g=l.target;r.triggerRef.current?.contains(g)&&l.preventDefault(),l.detail.originalEvent.type==="focusin"&&o.current&&l.preventDefault()}})}),De=m.forwardRef((a,t)=>{const{__scopeDialog:r,trapFocus:c,onOpenAutoFocus:o,onCloseAutoFocus:l,...g}=a,u=D(R,r),y=m.useRef(null),s=ee(t,y);return Ge(),e.jsxs(e.Fragment,{children:[e.jsx(Be,{asChild:!0,loop:!0,trapped:c,onMountAutoFocus:o,onUnmountAutoFocus:l,children:e.jsx(We,{role:"dialog",id:u.contentId,"aria-describedby":u.descriptionId,"aria-labelledby":u.titleId,"data-state":ne(u.open),...g,ref:s,onDismiss:()=>u.onOpenChange(!1)})}),e.jsxs(e.Fragment,{children:[e.jsx(vs,{titleId:u.titleId}),e.jsx(ys,{contentRef:y,descriptionId:u.descriptionId})]})]})}),te="DialogTitle",be=m.forwardRef((a,t)=>{const{__scopeDialog:r,...c}=a,o=D(te,r);return e.jsx(z.h2,{id:o.titleId,...c,ref:t})});be.displayName=te;var ke="DialogDescription",fs=m.forwardRef((a,t)=>{const{__scopeDialog:r,...c}=a,o=D(ke,r);return e.jsx(z.p,{id:o.descriptionId,...c,ref:t})});fs.displayName=ke;var Se="DialogClose",Ae=m.forwardRef((a,t)=>{const{__scopeDialog:r,...c}=a,o=D(Se,r);return e.jsx(z.button,{type:"button",...c,ref:t,onClick:$(a.onClick,()=>o.onOpenChange(!1))})});Ae.displayName=Se;function ne(a){return a?"open":"closed"}var Pe="DialogTitleWarning",[Os,Re]=He(Pe,{contentName:R,titleName:te,docsSlug:"dialog"}),vs=({titleId:a})=>{const t=Re(Pe),r=`\`${t.contentName}\` requires a \`${t.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${t.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${t.docsSlug}`;return m.useEffect(()=>{a&&(document.getElementById(a)||console.error(r))},[r,a]),null},Ns="DialogDescriptionWarning",ys=({contentRef:a,descriptionId:t})=>{const c=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${Re(Ns).contentName}}.`;return m.useEffect(()=>{const o=a.current?.getAttribute("aria-describedby");t&&o&&(document.getElementById(t)||console.warn(c))},[c,a,t]),null},Cs=ge,ws=ve,Ds=ye,bs=Ce,ks=we,Ss=be,As=Ae;function _e({...a}){return e.jsx(Cs,{"data-slot":"dialog",...a})}function Ie({...a}){return e.jsx(ws,{"data-slot":"dialog-trigger",...a})}function Ps({...a}){return e.jsx(Ds,{"data-slot":"dialog-portal",...a})}function Rs({className:a,...t}){return e.jsx(bs,{"data-slot":"dialog-overlay",className:H("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",a),...t})}function Te({className:a,children:t,showCloseButton:r=!0,...c}){return e.jsxs(Ps,{"data-slot":"dialog-portal",children:[e.jsx(Rs,{}),e.jsxs(ks,{"data-slot":"dialog-content",className:H("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",a),...c,children:[t,r&&e.jsxs(As,{"data-slot":"dialog-close",className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[e.jsx(Ve,{}),e.jsx("span",{className:"sr-only",children:"Close"})]})]})]})}function Fe({className:a,...t}){return e.jsx("div",{"data-slot":"dialog-header",className:H("flex flex-col gap-2 text-center sm:text-left",a),...t})}function Me({className:a,...t}){return e.jsx(Ss,{"data-slot":"dialog-title",className:H("text-lg leading-none font-semibold",a),...t})}function _s({jamId:a,currentUser:t,threads:r,onAddThread:c,onAddReply:o,isHost:l,isParticipant:g}){const[u,y]=m.useState(""),[s,f]=m.useState({}),[S,A]=m.useState(null),h=l||g,b=()=>{u.trim()&&h&&(c(u.trim()),y(""))},n=d=>{const j=s[d];j?.trim()&&h&&(o(d,j.trim()),f(_=>({..._,[d]:""})),A(null))},x=d=>{const j=new Date(d),q=new Date().getTime()-j.getTime(),O=Math.floor(q/(1e3*60*60)),G=Math.floor(O/24);if(G>0)return`${G}d ago`;if(O>0)return`${O}h ago`;{const B=Math.floor(q/6e4);return B>0?`${B}m ago`:"Just now"}};return e.jsxs(P,{children:[e.jsxs(I,{children:[e.jsxs(T,{className:"flex items-center space-x-2",children:[e.jsx(Z,{className:"w-5 h-5"}),e.jsxs("span",{children:["Discussion (",r.length,")"]})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Open discussion for all participants - ask questions, share updates, and coordinate details"})]}),e.jsxs(F,{className:"space-y-6",children:[h&&e.jsxs("div",{className:"space-y-3 p-4 bg-muted/30 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(E,{className:"w-8 h-8",children:[e.jsx(L,{src:t.image}),e.jsx(J,{children:t.name.charAt(0)})]}),e.jsx("span",{className:"font-medium",children:t.name}),l&&e.jsx(v,{variant:"default",className:"text-xs",children:"Host"})]}),e.jsx(X,{value:u,onChange:d=>y(d.target.value),placeholder:"Start a discussion, ask a question, or share an update...",rows:3}),e.jsx("div",{className:"flex justify-end",children:e.jsxs(N,{onClick:b,disabled:!u.trim(),size:"sm",children:[e.jsx(rs,{className:"w-4 h-4 mr-2"}),"Post"]})})]}),!h&&e.jsx("div",{className:"p-4 bg-muted/30 rounded-lg text-center",children:e.jsx("p",{className:"text-sm text-muted-foreground",children:"Join this jam session to participate in the discussion"})}),e.jsx("div",{className:"space-y-6",children:r.length===0?e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(Z,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),e.jsx("p",{children:"No discussions yet"}),e.jsx("p",{className:"text-sm",children:"Be the first to start a conversation!"})]}):r.map(d=>e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex space-x-3",children:[e.jsxs(E,{className:"w-10 h-10",children:[e.jsx(L,{src:d.author.image}),e.jsx(J,{children:d.author.name.charAt(0)})]}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"font-medium",children:d.author.name}),d.author.id===t.id&&e.jsx(v,{variant:"outline",className:"text-xs",children:"You"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:x(d.timestamp)})]}),e.jsx("div",{className:"bg-muted/50 rounded-lg p-3",children:e.jsx("p",{className:"text-sm whitespace-pre-wrap",children:d.content})}),e.jsxs("div",{className:"flex items-center space-x-4",children:[h&&e.jsxs(N,{variant:"ghost",size:"sm",onClick:()=>A(S===d.id?null:d.id),children:[e.jsx(is,{className:"w-4 h-4 mr-1"}),"Reply"]}),d.replies.length>0&&e.jsxs("span",{className:"text-sm text-muted-foreground",children:[d.replies.length," ",d.replies.length===1?"reply":"replies"]})]})]})]}),d.replies.length>0&&e.jsx("div",{className:"ml-13 space-y-3 border-l-2 border-muted pl-4",children:d.replies.map(j=>e.jsxs("div",{className:"flex space-x-3",children:[e.jsxs(E,{className:"w-8 h-8",children:[e.jsx(L,{src:j.author.image}),e.jsx(J,{children:j.author.name.charAt(0)})]}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"font-medium",children:j.author.name}),j.author.id===t.id&&e.jsx(v,{variant:"outline",className:"text-xs",children:"You"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:x(j.timestamp)})]}),e.jsx("div",{className:"bg-muted/30 rounded-lg p-3",children:e.jsx("p",{className:"text-sm whitespace-pre-wrap",children:j.content})})]})]},j.id))}),S===d.id&&h&&e.jsx("div",{className:"ml-13 space-y-3 border-l-2 border-muted pl-4",children:e.jsxs("div",{className:"flex space-x-3",children:[e.jsxs(E,{className:"w-8 h-8",children:[e.jsx(L,{src:t.image}),e.jsx(J,{children:t.name.charAt(0)})]}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"font-medium",children:t.name}),l&&e.jsx(v,{variant:"default",className:"text-xs",children:"Host"})]}),e.jsx(X,{value:s[d.id]||"",onChange:j=>f(_=>({..._,[d.id]:j.target.value})),placeholder:"Write a reply...",rows:2}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx(N,{variant:"outline",size:"sm",onClick:()=>A(null),children:"Cancel"}),e.jsx(N,{onClick:()=>n(d.id),disabled:!s[d.id]?.trim(),size:"sm",children:"Reply"})]})]})]})})]},d.id))})]})]})}function Es({currentUser:a=Ye[0],onBack:t=()=>{},onJoinJam:r=()=>{},onLeaveJam:c=()=>{},onAddSong:o=()=>{},onAddThread:l=()=>{},onAddReply:g=()=>{},onViewProfile:u=()=>{}}){const{id:y}=Ke(),{data:s,isLoading:f}=ms(y),[S,A]=m.useState(!1),[h,b]=m.useState({difficulty:"Medium"});if(f)return null;if(!s)return"No Jam found";const n=s.participants.some(i=>i.id===a.id),x=s.host.id===a.id,d=s.currentParticipants>=s.maxParticipants,j=s.maxParticipants-s.currentParticipants,_=()=>{h.title&&h.artist&&(o(s.id,{title:h.title,artist:h.artist,genre:h.genre||"",difficulty:h.difficulty||"Medium",duration:h.duration,key:h.key}),A(!1),b({difficulty:"Medium"}))},q=i=>{l(s.id,i)},O=(i,p)=>{g(s.id,i,p)},G=i=>new Date(i).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),B=i=>{const[p,Oe]=i.split(":"),ie=new Date;return ie.setHours(parseInt(p),parseInt(Oe)),ie.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0})};return e.jsxs("div",{className:"max-w-4xl mx-auto p-4 space-y-6",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(xe,{to:"/jams",children:e.jsxs(N,{variant:"outline",size:"sm",onClick:t,children:[e.jsx(Xe,{className:"w-4 h-4 mr-2"}),"Back to Jams"]})}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(v,{variant:s.type==="open"?"default":"secondary",children:s.type==="open"?"Open Session":"Private Session"}),e.jsx(v,{variant:"outline",children:s.skillLevel})]})]}),e.jsxs(P,{children:[e.jsx(I,{children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{className:"text-2xl",children:s.title}),e.jsxs("div",{className:"flex items-center space-x-2 text-muted-foreground",children:[e.jsx(Q,{route:`/profiles/${s.host.id}`,src:s.host.image,fallback:s.host.name.charAt(0),className:"w-8 h-8",onClick:()=>u(s.host.id)}),e.jsxs("span",{children:["Hosted by"," ",e.jsx("button",{onClick:()=>u(s.host.id),className:"text-foreground hover:text-primary transition-colors underline",children:s.host.name})]})]})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs(N,{variant:"outline",size:"sm",children:[e.jsx(os,{className:"w-4 h-4 mr-2"}),"Share"]}),e.jsxs(N,{variant:"outline",size:"sm",children:[e.jsx(Z,{className:"w-4 h-4 mr-2"}),"Message Host"]})]})]})}),e.jsxs(F,{className:"space-y-6",children:[e.jsx("p",{className:"text-muted-foreground",children:s.description}),e.jsxs("div",{className:"grid md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(ue,{className:"w-5 h-5 text-primary"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:G(s.date)}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Date"})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(Ze,{className:"w-5 h-5 text-primary"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:B(s.time)}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Time"})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(he,{className:"w-5 h-5 text-primary"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:s.location}),s.address&&e.jsx("p",{className:"text-sm text-muted-foreground",children:s.address})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"mb-2",children:"Genres"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:s.genres.map(i=>e.jsx(v,{variant:"outline",children:i},i))})]}),s.notes&&e.jsxs("div",{children:[e.jsx("h4",{className:"mb-2",children:"Additional Notes"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s.notes})]})]})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs(P,{children:[e.jsx(I,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(T,{className:"flex items-center space-x-2",children:[e.jsx(V,{className:"w-5 h-5"}),e.jsxs("span",{children:["Participants (",s.currentParticipants,"/",s.maxParticipants,")"]})]}),!d&&!n&&e.jsxs(N,{size:"sm",onClick:()=>r(s),children:[e.jsx(Ue,{className:"w-4 h-4 mr-2"}),"Join"]}),n&&!x&&e.jsx(N,{size:"sm",variant:"outline",onClick:()=>c(s),children:"Leave"})]})}),e.jsxs(F,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-primary/10 rounded-lg cursor-pointer hover:bg-primary/15 transition-colors",onClick:()=>u(s.host.id),children:[e.jsx(Q,{route:`/profiles/${s.host.id}`,src:s.host.image,fallback:s.host.name.charAt(0),className:"w-10 h-10",onClick:()=>u(s.host.id)}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium hover:text-primary",children:s.host.name}),e.jsxs("div",{className:"flex flex-wrap gap-1 mt-1",children:[s.host.instruments?.map(i=>e.jsx(v,{variant:"secondary",className:"text-xs",children:i},i)),e.jsx(v,{className:"text-xs",children:"Host"})]})]})]}),s.participants.map(i=>e.jsxs("div",{className:"flex items-center space-x-3 p-2 rounded-lg hover:bg-muted/50 cursor-pointer transition-colors",onClick:()=>u(i.id),children:[e.jsx(Q,{route:`/profiles/${i.id}`,src:i.image,fallback:i.name.charAt(0),className:"w-10 h-10",onClick:()=>u(i.id)}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium hover:text-primary",children:i.name}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:i?.instruments?.map(p=>e.jsx(v,{variant:"secondary",className:"text-xs",children:p},p))})]})]},i.id)),s.neededInstruments.length>0&&e.jsxs("div",{className:"pt-4 border-t",children:[e.jsx("h5",{className:"text-sm font-medium mb-2",children:"Still Looking For:"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:s.neededInstruments.map(i=>e.jsx(v,{variant:"outline",className:"text-xs",children:i},i))})]}),j>0&&e.jsx("div",{className:"text-center p-3 bg-muted/50 rounded-lg",children:e.jsxs("p",{className:"text-sm text-muted-foreground",children:[j," ",j===1?"spot":"spots"," remaining"]})})]})]}),e.jsxs(P,{children:[e.jsx(I,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(T,{className:"flex items-center space-x-2",children:[e.jsx(de,{className:"w-5 h-5"}),e.jsxs("span",{children:["Setlist (",s.setlist.length," songs)"]})]}),(n||x)&&e.jsxs(_e,{open:S,onOpenChange:A,children:[e.jsx(Ie,{asChild:!0,children:e.jsxs(N,{size:"sm",variant:"outline",children:[e.jsx(U,{className:"w-4 h-4 mr-2"}),"Add Song"]})}),e.jsxs(Te,{children:[e.jsx(Fe,{children:e.jsx(Me,{children:"Add Song to Setlist"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(w,{htmlFor:"song-title",children:"Song Title"}),e.jsx(C,{id:"song-title",value:h.title||"",onChange:i=>b(p=>({...p,title:i.target.value})),placeholder:"Song name"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(w,{htmlFor:"song-artist",children:"Artist"}),e.jsx(C,{id:"song-artist",value:h.artist||"",onChange:i=>b(p=>({...p,artist:i.target.value})),placeholder:"Artist name"})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(w,{htmlFor:"song-key",children:"Key"}),e.jsx(C,{id:"song-key",value:h.key||"",onChange:i=>b(p=>({...p,key:i.target.value})),placeholder:"C, Dm, etc."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(w,{htmlFor:"song-genre",children:"Genre"}),e.jsx(C,{id:"song-genre",value:h.genre||"",onChange:i=>b(p=>({...p,genre:i.target.value})),placeholder:"Rock, Jazz, etc."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(w,{htmlFor:"song-duration",children:"Duration (min)"}),e.jsx(C,{id:"song-duration",type:"number",value:h.duration||"",onChange:i=>b(p=>({...p,duration:parseInt(i.target.value)})),placeholder:"4"})]})]}),e.jsx(N,{onClick:_,className:"w-full",children:"Add to Setlist"})]})]})]})]})}),e.jsx(F,{children:s.setlist.length===0?e.jsxs("div",{className:"text-center p-6 text-muted-foreground",children:[e.jsx(de,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),e.jsx("p",{children:"No songs in the setlist yet"}),e.jsx("p",{className:"text-sm",children:"Be the first to suggest a song!"})]}):e.jsxs("div",{className:"space-y-3",children:[s.setlist.map((i,p)=>e.jsxs("div",{className:"flex items-center space-x-3 p-3 rounded-lg border",children:[e.jsx("div",{className:"w-8 h-8 bg-primary/20 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-sm font-medium",children:p+1})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium",children:i.title}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["by ",i.artist,i.key&&` • Key: ${i.key}`,i.duration&&` • ${i.duration}min`]})]}),e.jsxs("div",{className:"flex flex-col items-end space-y-1",children:[e.jsx(v,{variant:"outline",className:"text-xs",children:i.difficulty}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:["by ",i.suggestedBy]})]})]},i.id)),e.jsxs("div",{className:"text-center pt-2 text-sm text-muted-foreground",children:["Total duration: ",s.setlist.reduce((i,p)=>i+(p.duration||0),0)," ","minutes"]})]})})]})]}),(s.equipment||s.price)&&e.jsxs(P,{children:[e.jsx(I,{children:e.jsx(T,{children:"Additional Information"})}),e.jsxs(F,{className:"space-y-4",children:[s.equipment&&e.jsxs("div",{children:[e.jsx("h4",{className:"mb-2",children:"Available Equipment"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:s.equipment.map(i=>e.jsx(v,{variant:"secondary",children:i},i))})]}),s.price&&e.jsxs("div",{children:[e.jsx("h4",{className:"mb-2",children:"Cost"}),e.jsxs("p",{className:"text-lg font-medium",children:["$",s.price," per person"]})]})]})]}),e.jsx(_s,{jamId:s.id,currentUser:a,threads:s.discussion||[],onAddThread:q,onAddReply:O,isHost:x,isParticipant:n})]})}const Is=()=>me,Ts=a=>pe({queryKey:["jams"],queryFn:()=>Is(),...a});function Ls({onCreateJam:a=()=>{}}){const[t,r]=m.useState(""),[c,o]=m.useState(""),[l,g]=m.useState(""),[u,y]=m.useState(!1),[s,f]=m.useState({genres:[],type:"open",maxParticipants:4}),{data:S,isLoading:A}=Ts();if(A)return null;if(!S)return"No jam sessions found";const h=S.filter(n=>{const x=n.title.toLowerCase().includes(t.toLowerCase())||n.description.toLowerCase().includes(t.toLowerCase()),d=!c||n.genres.includes(c),j=!l||n.date===l;return x&&d&&j}),b=()=>{s.title&&s.date&&s.time&&s.location&&(a({title:s.title,description:s.description||"",date:s.date,time:s.time,location:s.location,maxParticipants:s.maxParticipants||4,currentParticipants:1,genres:s.genres||[],skillLevel:s.skillLevel||"All Levels",type:s.type||"open",setlist:[],neededInstruments:[]}),y(!1),f({genres:[],type:"open",maxParticipants:4}))};return e.jsxs("div",{className:"max-w-4xl mx-auto space-y-6",children:[e.jsxs("div",{className:"flex flex-col space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl mb-2",children:"Jams"}),e.jsx("p",{children:"Discover Jam Sessions"})]}),e.jsxs(_e,{open:u,onOpenChange:y,children:[e.jsx(Ie,{asChild:!0,children:e.jsxs(N,{children:[e.jsx(U,{className:"w-4 h-4 mr-2"}),"Create Jam"]})}),e.jsxs(Te,{className:"max-w-md",children:[e.jsx(Fe,{children:e.jsx(Me,{children:"Create New Jam Session"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(w,{htmlFor:"jam-title",children:"Session Title"}),e.jsx(C,{id:"jam-title",value:s.title||"",onChange:n=>f(x=>({...x,title:n.target.value})),placeholder:"Sunday Jazz Jam"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(w,{htmlFor:"jam-description",children:"Description"}),e.jsx(X,{id:"jam-description",value:s.description||"",onChange:n=>f(x=>({...x,description:n.target.value})),placeholder:"Tell musicians what to expect...",rows:3})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(w,{htmlFor:"jam-date",children:"Date"}),e.jsx(C,{id:"jam-date",type:"date",value:s.date||"",onChange:n=>f(x=>({...x,date:n.target.value}))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(w,{htmlFor:"jam-time",children:"Time"}),e.jsx(C,{id:"jam-time",type:"time",value:s.time||"",onChange:n=>f(x=>({...x,time:n.target.value}))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(w,{htmlFor:"jam-location",children:"Location"}),e.jsx(C,{id:"jam-location",value:s.location||"",onChange:n=>f(x=>({...x,location:n.target.value})),placeholder:"Venue name and address"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(w,{htmlFor:"jam-participants",children:"Max Participants"}),e.jsx(C,{id:"jam-participants",type:"number",min:"2",max:"20",value:s.maxParticipants||4,onChange:n=>f(x=>({...x,maxParticipants:parseInt(n.target.value)}))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(w,{htmlFor:"jam-skill",children:"Skill Level"}),e.jsxs(le,{value:s.skillLevel,onValueChange:n=>f(x=>({...x,skillLevel:n})),children:[e.jsx(re,{children:e.jsx(ce,{placeholder:"All Levels"})}),e.jsxs(oe,{children:[e.jsx(k,{value:"All Levels",children:"All Levels"}),e.jsx(k,{value:"Beginner",children:"Beginner"}),e.jsx(k,{value:"Intermediate",children:"Intermediate"}),e.jsx(k,{value:"Advanced",children:"Advanced"})]})]})]})]}),e.jsx(N,{onClick:b,className:"w-full",children:"Create Jam Session"})]})]})]})]}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(Qe,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-4 h-4"}),e.jsx(C,{placeholder:"Search jam sessions...",value:t,onChange:n=>r(n.target.value),className:"pl-10"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(le,{value:c||"all",onValueChange:n=>o(n==="all"?"":n),children:[e.jsx(re,{className:"w-[140px]",children:e.jsx(ce,{placeholder:"All Genres"})}),e.jsxs(oe,{children:[e.jsx(k,{value:"all",children:"All Genres"}),e.jsx(k,{value:"Jazz",children:"Jazz"}),e.jsx(k,{value:"Rock",children:"Rock"}),e.jsx(k,{value:"Folk",children:"Folk"}),e.jsx(k,{value:"Blues",children:"Blues"}),e.jsx(k,{value:"Indie",children:"Indie"})]})]}),e.jsx(C,{type:"date",value:l,onChange:n=>g(n.target.value),className:"w-[160px]"})]})]})]}),e.jsxs("div",{className:"grid gap-4",children:[h.map(n=>e.jsx(xe,{to:`/jams/${n.id}`,className:"block",children:e.jsxs(P,{className:"hover:shadow-md transition-shadow cursor-pointer",children:[e.jsx(I,{className:"pb-3",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(T,{className:"text-lg",children:n.title}),e.jsx(ss,{className:"w-5 h-5 text-muted-foreground"})]}),e.jsxs("div",{className:"flex items-center text-sm text-muted-foreground mt-1",children:[e.jsxs(E,{className:"w-6 h-6 mr-2",children:[e.jsx(L,{src:n.host.image}),e.jsx(J,{className:"text-xs",children:n.host.name.charAt(0)})]}),"Hosted by ",n.host.name]})]}),e.jsx(v,{variant:n.type==="open"?"default":"secondary",children:n.type==="open"?"Open":"Private"})]})}),e.jsxs(F,{className:"space-y-4",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:n.description}),e.jsxs("div",{className:"flex flex-wrap gap-4 text-sm text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(ue,{className:"w-4 h-4 mr-1"}),new Date(n.date).toLocaleDateString()," at ",n.time]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(he,{className:"w-4 h-4 mr-1"}),n.location]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(V,{className:"w-4 h-4 mr-1"}),n.currentParticipants,"/",n.maxParticipants," participants"]})]}),e.jsxs("div",{className:"flex flex-wrap gap-1",children:[n.genres.map(x=>e.jsx(v,{variant:"outline",className:"text-xs",children:x},x)),e.jsx(v,{variant:"secondary",className:"text-xs",children:n.skillLevel})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:[n.maxParticipants-n.currentParticipants," spots left",n.setlist.length>0&&` • ${n.setlist.length} songs planned`]}),e.jsx(N,{onClick:x=>{x.stopPropagation()},disabled:n.currentParticipants>=n.maxParticipants,size:"sm",children:n.currentParticipants>=n.maxParticipants?"Full":"Join"})]})]})]})},n.id)),h.length===0&&e.jsxs(P,{className:"p-8 text-center",children:[e.jsx(V,{className:"w-12 h-12 mx-auto text-muted-foreground mb-4"}),e.jsx("h3",{className:"mb-2",children:"No jam sessions found"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"Try adjusting your search filters or create a new jam session."}),e.jsxs(N,{onClick:()=>y(!0),children:[e.jsx(U,{className:"w-4 h-4 mr-2"}),"Create Your First Jam"]})]})]})]})}export{Es as JamDetails,Ls as JamDiscovery};
